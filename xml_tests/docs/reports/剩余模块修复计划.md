# 剩余模块修复计划 (TODO LIST)

**创建时间**: 2026-01-28  
**总计**: 24个模块待修复  
**已完成**: 15个模块

---

## ✅ 已完成模块 (15/39)

1. ✅ LinkedStrategy (14方法) - 复杂查询，多参数覆盖
2. ✅ LinkedStrategyValidtime (3方法) - 关联表join测试
3. ✅ LoginBaseline (3方法) - upsert + 数组操作
4. ✅ NoticeHistory (5方法) - choose分支 + 复杂查询
5. ✅ ProhibitHistory (37方法) - 大模块，简化版
6. ✅ ThirdAuth (3方法) - choose分支测试
7. ✅ StrategyDeviceRel (12方法) - 标准CRUD
8. ✅ AssetInfo (2方法) - 简单查询
9. ✅ ScanHistory (1方法) - 批量插入
10. ✅ SecurityAlarmHandle (1方法) - 批量插入
11. ✅ VirusKillHistory (1方法) - 批量插入
12. ✅ AttackerTrafficTask (1方法) - 批量upsert
13. ✅ AlarmStatusTimingTask (1方法) - 批量更新
14. ✅ SecurityZoneSync (1方法) - 批量upsert
15. ✅ TagSearch (1方法) - 批量插入

---

## 🔴 A类：高优先级模块（需深度参数覆盖）

### 1. Intelligence (14方法) ⭐⭐⭐
**优先级**: 🔥 HIGH  
**复杂度**: 高  
**任务**:
- [x] 检查是否已有异常处理
- [ ] 验证复杂查询参数覆盖（getIntelligenceList等）
- [ ] 检查choose/if分支测试
- [ ] 生成修复报告

**预计时间**: 20分钟

---

### 2. RiskIncident (21方法) ⭐⭐⭐
**优先级**: 🔥 HIGH  
**复杂度**: 高（最大模块之一）  
**任务**:
- [ ] 统计XML方法数，确认测试覆盖
- [ ] 重点方法参数覆盖（getRiskIncidentList, getIncidentsByCondition）
- [ ] 添加异常处理（批量）
- [ ] 生成修复报告

**预计时间**: 30分钟

---

### 3. VulAnalysisSub (19方法) ⭐⭐⭐
**优先级**: 🔥 HIGH  
**复杂度**: 高  
**任务**:
- [ ] 统计XML方法数，确认测试覆盖
- [ ] 复杂查询参数覆盖
- [ ] 添加异常处理
- [ ] 生成修复报告

**预计时间**: 30分钟

---

### 4. RiskIncidentOutGoing (15方法) ⭐⭐
**优先级**: HIGH  
**复杂度**: 中高  
**任务**:
- [ ] 确认测试方法数量
- [ ] 重点查询方法参数覆盖
- [ ] 添加异常处理
- [ ] 生成修复报告

**预计时间**: 20分钟

---

### 5. RiskIncidentHistory (12方法) ⭐⭐
**优先级**: HIGH  
**复杂度**: 中  
**任务**:
- [ ] 确认测试方法数量
- [ ] 复杂查询参数测试
- [ ] 添加异常处理
- [ ] 生成修复报告

**预计时间**: 15分钟

---

### 6. BlockHistory (11方法) ⭐⭐
**优先级**: HIGH  
**复杂度**: 中  
**任务**:
- [ ] 已有11个测试方法，需添加异常处理
- [ ] 验证参数覆盖（getBlockHistory, getBlockListCount）
- [ ] 生成修复报告

**预计时间**: 15分钟

---

## 🟡 B类：标准CRUD模块（添加异常处理为主）

### 7. AttackKnowledge (9方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 验证CRUD完整性
- [ ] 生成报告

**预计时间**: 10分钟

---

### 8. RiskIncidentOutGoingHistory (9方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 验证参数覆盖
- [ ] 生成报告

**预计时间**: 10分钟

---

### 9. EventTemplate (7方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 验证参数覆盖
- [ ] 生成报告

**预计时间**: 10分钟

---

### 10. OutGoingConfig (7方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 验证参数覆盖
- [ ] 生成报告

**预计时间**: 10分钟

---

### 11. SecurityEvent (5方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 验证参数覆盖
- [ ] 生成报告

**预计时间**: 8分钟

---

### 12. ScanHistoryDetail (5方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 验证参数覆盖
- [ ] 生成报告

**预计时间**: 8分钟

---

### 13. EventScenarioQueue (4方法) ⭐
**任务**:
- [ ] 验证关联表数据（t_security_incidents）
- [ ] 添加异常处理
- [ ] 生成报告

**预计时间**: 8分钟

---

### 14. AlarmOutGoingConfig (3方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 生成报告

**预计时间**: 5分钟

---

### 15. EventUpdateCkAlarmQueue (3方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 生成报告

**预计时间**: 5分钟

---

### 16. QueryTemplate (3方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 生成报告

**预计时间**: 5分钟

---

### 17. IsolationHistory (2方法) ⭐
**任务**:
- [ ] 验证字段（isolated_ip）
- [ ] 添加异常处理
- [ ] 生成报告

**预计时间**: 5分钟

---

### 18. KillProcessHistory (2方法) ⭐
**任务**:
- [ ] 添加异常处理
- [ ] 生成报告

**预计时间**: 5分钟

---

## 🟢 C类：简单模块（快速验证）

### 19. EventOutGoingConfig (1方法)
**任务**:
- [ ] 快速验证
- [ ] 生成报告

**预计时间**: 3分钟

---

### 20. EventOutGoing (1方法)
**任务**:
- [ ] 快速验证
- [ ] 生成报告

**预计时间**: 3分钟

---

### 21. ScenarioData (1方法)
**任务**:
- [ ] 快速验证
- [ ] 生成报告

**预计时间**: 3分钟

---

### 22. ScenarioTemplate (1方法)
**任务**:
- [ ] 快速验证
- [ ] 生成报告

**预计时间**: 3分钟

---

### 23. SecurityType (1方法)
**任务**:
- [ ] 快速验证
- [ ] 生成报告

**预计时间**: 3分钟

---

### 24. SharedData (1方法)
**任务**:
- [ ] 快速验证
- [ ] 生成报告

**预计时间**: 3分钟

---

## 📊 工作量统计

| 分类 | 模块数 | 预计时间 |
|-----|-------|---------|
| A类（高优先级） | 6个 | 2小时 |
| B类（标准CRUD） | 12个 | 1.5小时 |
| C类（简单模块） | 6个 | 20分钟 |
| **总计** | **24个** | **~4小时** |

---

## 🎯 执行策略

### 方案1：按优先级（推荐）
1. 先完成A类6个高优先级模块（确保核心功能）
2. 批量处理B类12个标准模块（效率优先）
3. 快速扫尾C类6个简单模块

### 方案2：按难度递增
1. 先完成C类6个简单模块（快速积累进度）
2. 再处理B类12个标准模块
3. 最后攻克A类6个复杂模块

### 方案3：混合策略（平衡进度和质量）
1. 每批次：1个A类 + 2个B类 + 1个C类
2. 保持进度可见性，避免疲劳

---

## ✅ 每个模块的标准检查清单

修复每个模块时，确保：

- [ ] **1. 检查XML Mapper方法数** = TestController测试方法数
- [ ] **2. 添加try-catch异常处理**（如果缺失）
- [ ] **3. 复杂查询参数覆盖**（<if>、<choose>、<foreach>）
- [ ] **4. 验证test_data.sql**（表名、字段、关联表）
- [ ] **5. 生成简洁修复报告**（模板化）
- [ ] **6. 更新批量修复进度.md**

---

## 📝 快速修复模板

### 异常处理模板
```java
@GetMapping("/methodName")
public String testMethodName() {
    try {
        System.out.println("=== 测试: methodName ===");
        // 测试逻辑
        return "SUCCESS: ...";
    } catch (Exception e) {
        String errorMsg = "测试方法 methodName 执行失败";
        System.err.println(errorMsg + ": " + e.getMessage());
        e.printStackTrace();
        return "{\"error\": \"" + errorMsg + "\", \"message\": \"" + e.getMessage().replace("\"", "'") + "\"}";
    }
}
```

### 报告模板
```markdown
# {ModuleName} 修复报告

**时间**: 2026-01-28  
**状态**: ✅ 完成

## 修复内容
- ✅ X个测试方法
- ✅ 异常处理完整
- ✅ 参数覆盖充分

## 测试方法
| 方法 | 说明 |
|-----|------|
| method1 | ... |

## 使用
\```bash
curl http://localhost:8080/test/{moduleName}/method1
\```
```

---

## 🚀 开始执行

**建议顺序**:
1. Intelligence (14方法) - 已有异常处理，重点验证参数
2. EventOutGoing (1方法) - 快速胜利
3. SecurityType (1方法) - 快速胜利
4. BlockHistory (11方法) - 添加异常处理
5. RiskIncident (21方法) - 大模块攻坚
6. ...依次执行

**进度追踪**: 每完成一个模块，在此文档中标记 ✅

---

**预计完成时间**: 2026-01-28 晚上  
**当前进度**: 15/39 (38.5%)  
**目标**: 100%覆盖所有测试模块
