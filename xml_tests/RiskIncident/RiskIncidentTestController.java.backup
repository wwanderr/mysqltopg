package com.test.controller;

import com.dbapp.extension.xdr.threatMonitor.mapper.RiskIncidentMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import java.util.*;

@RestController
@RequestMapping("/test/riskIncident")
public class RiskIncidentTestController {
    @Autowired
    private RiskIncidentMapper mapper;

    @GetMapping("/aggClueSecurityEventByName")
    public String test01() { return "SUCCESS: " + mapper.aggClueSecurityEventByName(new HashMap<>()).size(); }
    
    @GetMapping("/mappingNormalSecurityEvent")
    public String test02() { return "SUCCESS: " + mapper.mappingNormalSecurityEvent(new HashMap<>()).size(); }
    
    @GetMapping("/backUpLastTermData")
    public String test03() { return "SUCCESS: " + mapper.backUpLastTermData(new HashMap<>()); }
    
    @GetMapping("/batchInsertOrUpdateIncident")
    public String test04() { mapper.batchInsertOrUpdateIncident(new ArrayList<>()); return "SUCCESS"; }
    
    @GetMapping("/deleteOldIncidentAnalysis")
    public String test05() { return "SUCCESS: " + mapper.deleteOldIncidentAnalysis(30); }
    
    @GetMapping("/deleteOldIncident")
    public String test06() { return "SUCCESS: " + mapper.deleteOldIncident(30); }
    
    @GetMapping("/selectOldIncidentByCodes")
    public String test07() { return "SUCCESS: " + mapper.selectOldIncidentByCodes(Arrays.asList("C001")).size(); }
    
    @GetMapping("/getRiskList")
    public String test08() { return "SUCCESS: " + mapper.getRiskList(new HashMap<>()).size(); }
    
    @GetMapping("/getCountByStatus")
    public String test09() { return "SUCCESS: " + mapper.getCountByStatus(new HashMap<>()).size(); }
    
    @GetMapping("/getByEventCode")
    public String test10() { return "SUCCESS: " + mapper.getByEventCode("E001").size(); }
    
    @GetMapping("/selectEventAndTempById")
    public String test11() { return "SUCCESS: " + mapper.selectEventAndTempById(1); }
    
    @GetMapping("/selectAllByIdList")
    public String test12() { return "SUCCESS: " + mapper.selectAllByIdList(Arrays.asList(1, 2)).size(); }
    
    @GetMapping("/queryEventCount")
    public String test13() { return "SUCCESS: " + mapper.queryEventCount(new HashMap<>()).size(); }
    
    @GetMapping("/queryIncidentsCount")
    public String test14() { return "SUCCESS: " + mapper.queryIncidentsCount(new HashMap<>()).size(); }
    
    @GetMapping("/queryKillChains")
    public String test15() { return "SUCCESS: " + mapper.queryKillChains(new HashMap<>()).size(); }
    
    @GetMapping("/getEventIdsById")
    public String test16() { return "SUCCESS: " + mapper.getEventIdsById(1); }
    
    @GetMapping("/getFilterContent")
    public String test17() { return "SUCCESS: " + mapper.getFilterContent(1); }
    
    @GetMapping("/FocusIpMessage")
    public String test18() { return "SUCCESS: " + mapper.FocusIpMessage(Arrays.asList("192.168.1.1")).size(); }
    
    @GetMapping("/getFocusObject")
    public String test19() { return "SUCCESS: " + mapper.getFocusObject().size(); }
}
